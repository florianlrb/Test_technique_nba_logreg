
FROM python:3.11-slim

WORKDIR /app
COPY requirements_api.txt ./
RUN pip install --no-cache-dir -r requirements_api.txt

COPY app_api.py ./
# Mount model & thresholds at runtime or bake them in:
# COPY model_final_explained.joblib model_final.joblib
# COPY thresholds_final_explained.json thresholds_final.json

ENV MODEL_PATH=model_final.joblib
ENV THRESHOLDS_PATH=thresholds_final.json
ENV PRED_MODE=balanced
ENV DEFAULT_THRESHOLD=0.5

EXPOSE 8000
CMD ["uvicorn", "app_api:app", "--host", "0.0.0.0", "--port", "8000"]
